{"ast":null,"code":"import _regeneratorRuntime from\"F:/sunshine-full-project/agustine-hotel--main/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"F:/sunshine-full-project/agustine-hotel--main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useQuery}from\"@tanstack/react-query\";import React,{useContext,useEffect,useState}from\"react\";import toast from\"react-hot-toast\";import{Link}from\"react-router-dom\";import{SyncLoader}from\"react-spinners\";import{AuthContext}from\"../../Context/AuthContext/UserContext\";import BookedRoomCard from\"./BookedRoomCard\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Bookings=function Bookings(){var _useContext=useContext(AuthContext),user=_useContext.user,logOut=_useContext.logOut;var _useQuery=useQuery({queryKey:[\"bookedRoom\",user===null||user===void 0?void 0:user.email],queryFn:function(){var _queryFn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://hotel-web-server.vercel.app/bookings?email=\".concat(user===null||user===void 0?void 0:user.email),{headers:{authorization:\"bearer \".concat(localStorage.getItem(\"Radission BluToken\"))}});case 2:res=_context.sent;if(!(res.status===401||res.status===403)){_context.next=7;break;}return _context.abrupt(\"return\",logOut());case 7:_context.next=9;return res.json();case 9:data=_context.sent;console.log(res);return _context.abrupt(\"return\",data);case 12:case\"end\":return _context.stop();}}},_callee);}));function queryFn(){return _queryFn.apply(this,arguments);}return queryFn;}()}),_useQuery$data=_useQuery.data,bookedRomm=_useQuery$data===void 0?[]:_useQuery$data,isLoading=_useQuery.isLoading,refetch=_useQuery.refetch;if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center m-80\",children:/*#__PURE__*/_jsx(SyncLoader,{color:\"hsla(86, 0%, 100%, 1)\",size:15})});}var handleCancelBook=function handleCancelBook(id){fetch(\"https://hotel-web-server.vercel.app/orders/\".concat(id),{method:\"DELETE\"}).then(function(res){if(res.status===401||res.status===403){return logOut();}return res.json();}).then(function(data){console.log(data);if(data.deletedCount>0)toast.error(\"You successFully Canceled Your Book\");refetch();});};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\" text-center bg-gray-900 rounded-lg h-screen w-full z-0 drop-shadow-lg p-5\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-3xl text-gray-200 font-bold my-4\",children:\" Your Booking\"}),bookedRomm.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"You Have not any booked Room Yet.\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Book a\",\" \",/*#__PURE__*/_jsx(Link,{className:\"underline\",to:\"/rooms\",children:\"Room?\"})]})]}):/*#__PURE__*/_jsx(_Fragment,{children:bookedRomm.map(function(booked){return/*#__PURE__*/_jsx(BookedRoomCard,{booked:booked,handleCancelBook:handleCancelBook},booked._id);})})]})});};export default Bookings;","map":{"version":3,"names":["useQuery","React","useContext","useEffect","useState","toast","Link","SyncLoader","AuthContext","BookedRoomCard","Bookings","user","logOut","queryKey","email","queryFn","fetch","headers","authorization","localStorage","getItem","res","status","json","data","console","log","bookedRomm","isLoading","refetch","handleCancelBook","id","method","then","deletedCount","error","length","map","booked","_id"],"sources":["F:/sunshine-full-project/agustine-hotel--main/src/Components/Dashboard/Bookings.js"],"sourcesContent":["import { useQuery } from \"@tanstack/react-query\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport toast from \"react-hot-toast\";\nimport { Link } from \"react-router-dom\";\nimport { SyncLoader } from \"react-spinners\";\nimport { AuthContext } from \"../../Context/AuthContext/UserContext\";\nimport BookedRoomCard from \"./BookedRoomCard\";\n\nconst Bookings = () => {\n  const { user, logOut } = useContext(AuthContext);\n\n  const {\n    data: bookedRomm = [],\n    isLoading,\n    refetch,\n  } = useQuery({\n    queryKey: [\"bookedRoom\", user?.email],\n    queryFn: async () => {\n      const res = await fetch(\n        `https://hotel-web-server.vercel.app/bookings?email=${user?.email}`,\n        {\n          headers: {\n            authorization: `bearer ${localStorage.getItem(\n              \"Radission BluToken\"\n            )}`,\n          },\n        }\n      );\n      if (res.status === 401 || res.status === 403) {\n        return logOut();\n      } else {\n        const data = await res.json();\n\n        console.log(res);\n        return data;\n      }\n    },\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center m-80\">\n        <SyncLoader color=\"hsla(86, 0%, 100%, 1)\" size={15} />\n      </div>\n    );\n  }\n\n  const handleCancelBook = (id) => {\n    fetch(`https://hotel-web-server.vercel.app/orders/${id}`, {\n      method: \"DELETE\",\n    })\n      .then((res) => {\n        if (res.status === 401 || res.status === 403) {\n          return logOut();\n        }\n        return res.json();\n      })\n      .then((data) => {\n        console.log(data);\n        if (data.deletedCount > 0)\n          toast.error(\"You successFully Canceled Your Book\");\n        refetch();\n      });\n  };\n\n  return (\n    <div>\n      <div className=\" text-center bg-gray-900 rounded-lg h-screen w-full z-0 drop-shadow-lg p-5\">\n        <h3 className=\"text-3xl text-gray-200 font-bold my-4\"> Your Booking</h3>\n        {bookedRomm.length === 0 ? (\n          <div className=\"text-center\">\n            <h1>You Have not any booked Room Yet.</h1>\n            <p>\n              Book a{\" \"}\n              <Link className=\"underline\" to=\"/rooms\">\n                Room?\n              </Link>\n            </p>\n          </div>\n        ) : (\n          <>\n            {bookedRomm.map((booked) => (\n              <BookedRoomCard\n                key={booked._id}\n                booked={booked}\n                handleCancelBook={handleCancelBook}\n              ></BookedRoomCard>\n            ))}\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Bookings;\n"],"mappings":"sRAAA,OAASA,QAAT,KAAyB,uBAAzB,CACA,MAAOC,MAAP,EAAgBC,UAAhB,CAA4BC,SAA5B,CAAuCC,QAAvC,KAAuD,OAAvD,CACA,MAAOC,MAAP,KAAkB,iBAAlB,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,UAAT,KAA2B,gBAA3B,CACA,OAASC,WAAT,KAA4B,uCAA5B,CACA,MAAOC,eAAP,KAA2B,kBAA3B,C,6IAEA,GAAMC,SAAQ,CAAG,QAAXA,SAAW,EAAM,CACrB,gBAAyBR,UAAU,CAACM,WAAD,CAAnC,CAAQG,IAAR,aAAQA,IAAR,CAAcC,MAAd,aAAcA,MAAd,CAEA,cAIIZ,QAAQ,CAAC,CACXa,QAAQ,CAAE,CAAC,YAAD,CAAeF,IAAf,SAAeA,IAAf,iBAAeA,IAAI,CAAEG,KAArB,CADC,CAEXC,OAAO,mFAAE,wKACWC,MAAK,8DACiCL,IADjC,SACiCA,IADjC,iBACiCA,IAAI,CAAEG,KADvC,EAErB,CACEG,OAAO,CAAE,CACPC,aAAa,kBAAYC,YAAY,CAACC,OAAb,CACvB,oBADuB,CAAZ,CADN,CADX,CAFqB,CADhB,QACDC,GADC,oBAWHA,GAAG,CAACC,MAAJ,GAAe,GAAf,EAAsBD,GAAG,CAACC,MAAJ,GAAe,GAXlC,0DAYEV,MAAM,EAZR,+BAccS,IAAG,CAACE,IAAJ,EAdd,QAcCC,IAdD,eAgBLC,OAAO,CAACC,GAAR,CAAYL,GAAZ,EAhBK,gCAiBEG,IAjBF,yDAAF,+EAFI,CAAD,CAJZ,0BACEA,IADF,CACQG,UADR,yBACqB,EADrB,gBAEEC,SAFF,WAEEA,SAFF,CAGEC,OAHF,WAGEA,OAHF,CA4BA,GAAID,SAAJ,CAAe,CACb,mBACE,YAAK,SAAS,CAAC,0BAAf,uBACE,KAAC,UAAD,EAAY,KAAK,CAAC,uBAAlB,CAA0C,IAAI,CAAE,EAAhD,EADF,EADF,CAKD,CAED,GAAME,iBAAgB,CAAG,QAAnBA,iBAAmB,CAACC,EAAD,CAAQ,CAC/Bf,KAAK,sDAA+Ce,EAA/C,EAAqD,CACxDC,MAAM,CAAE,QADgD,CAArD,CAAL,CAGGC,IAHH,CAGQ,SAACZ,GAAD,CAAS,CACb,GAAIA,GAAG,CAACC,MAAJ,GAAe,GAAf,EAAsBD,GAAG,CAACC,MAAJ,GAAe,GAAzC,CAA8C,CAC5C,MAAOV,OAAM,EAAb,CACD,CACD,MAAOS,IAAG,CAACE,IAAJ,EAAP,CACD,CARH,EASGU,IATH,CASQ,SAACT,IAAD,CAAU,CACdC,OAAO,CAACC,GAAR,CAAYF,IAAZ,EACA,GAAIA,IAAI,CAACU,YAAL,CAAoB,CAAxB,CACE7B,KAAK,CAAC8B,KAAN,CAAY,qCAAZ,EACFN,OAAO,GACR,CAdH,EAeD,CAhBD,CAkBA,mBACE,kCACE,aAAK,SAAS,CAAC,4EAAf,wBACE,WAAI,SAAS,CAAC,uCAAd,2BADF,CAEGF,UAAU,CAACS,MAAX,GAAsB,CAAtB,cACC,aAAK,SAAS,CAAC,aAAf,wBACE,yDADF,cAEE,8BACS,GADT,cAEE,KAAC,IAAD,EAAM,SAAS,CAAC,WAAhB,CAA4B,EAAE,CAAC,QAA/B,mBAFF,GAFF,GADD,cAWC,yBACGT,UAAU,CAACU,GAAX,CAAe,SAACC,MAAD,qBACd,KAAC,cAAD,EAEE,MAAM,CAAEA,MAFV,CAGE,gBAAgB,CAAER,gBAHpB,EACOQ,MAAM,CAACC,GADd,CADc,EAAf,CADH,EAbJ,GADF,EADF,CA4BD,CArFD,CAuFA,cAAe7B,SAAf"},"metadata":{},"sourceType":"module"}